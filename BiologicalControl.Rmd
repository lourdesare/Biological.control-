---
title: "Biological control of important fungal diseases of potato and raspberry by two *Bacillus velezensis* strains"
author: "Lourdes Arellano, Antonia Fernandes, Juliana Cajiao and Rosario Heribia"
date: "20/01/2022"
output:
  html_document:
    code_folding: hide
    highlight: tango 
    toc: yes 
    toc_depth: 6 
---

```{r}
library(knitr)
knitr::opts_chunk$set(
  echo = TRUE,                    
  results = 'markup',                 
  fig.path = "results/",            
  fig.width = 10,                   
  fig.height = 6.1803,              
  dev = "png",                      
  dev.args = list(type = "cairo"),  
  dpi = 100)
```

## Introduction 
Fungal phytopathogens affect agricultural crops lead to a improtant decrease in their quality and production. They act as a threat to crops through various mechanisms of pathogenesis that compromise the immune system of the plants. The use of fungicides against fungal plant diseases improves crop yield, quality, and shelf-life (Brauer *et al*., 2019).  Nevertheless, the irrational uses of this products triggers to health problems, and can also cause severe damage to the environment. Accumulation of pesticides in the environment disrupts the ecological balance and raises pathogen resistance to pesticides. Thus, the application of fungicides in agriculture should be under strict regulation to ensure that commercialized foods are safe for consumption and pose negligible risks of acute toxicity due to carry-over (Brauer *et al*., 2019).   

In the case of potato and raspberry plants, they are affected by important diseases as stem canker and black scurf, causes by the fungi *Rhizoctonia solani* and *Didymella applanata*. Recently, two strains of the bacteria *Bacillus velezensis*, specifically BZR 336g and BZR 517, have been tested as potential biological control of these diseases (Asaturova et al., 2020).

*Bacillus velezensis*, an antagonistic bacteria produces several antimicrobial compounds as secondary metabolites against phytopathogens. *B. velezensis* produces spores, which can be used for developing an effective biopesticide. Previously, many studies have demonstrated that several secondary metabolites produced by antagonistic bacteria, play key roles in the control of various phytopathogens. Furthermore, *Bacillus* spp., have been found to produce cyclic lipopeptides (CLPs), which play a key role in antimicrobial activity (Soo Kim *et al*., 2021).  

Different methodologies can be applied for the evaluation of the effectiveness of pesticides with different factors and levels; and for this, a variance test must be carried out. An example is Duncan's test, which is used to compare all pairs of means. It was first developed by Duncan in 1951 but later was modified by himself, generating what is now called Duncan's New Multiple Range Method.

To apply this test, the following stages must be passed: determine the standard error (standard deviation) of each mean; obtained from the Anova table. Then, with the degrees of freedom of the error and the level of significance, the values, intervals or standardized significant amplitudes are determined using Duncan's tables of standardized amplitudes, then the minimum significant amplitudes are determined. Following this, the average results of the experiment are ordered in increasing order and the ordered means are compared: The highest average, with the lowest, comparing this difference with the least significant interval.

This process continues until the differences between all possible pairs have been compared. If an observed difference is greater than the minimum significant interval, it is concluded that the pair of means compared are significantly different (UNAL, 2021). 

Another variance test that can be applied is the Tukey test. This method was proposed by Tukey (1952) and is very similar in application to the DMS test, except for the fact that instead of using the  distributions as the basis for making comparisons, the standardized or studentized range distribution is used. In this test, a single value is used against which all possible pairs of means are compared. Tukey's comparison method was reformed by Kramer (1956) for cases in which the number of replicas is not equal. This method is known as the Tukey-Kramer method. (UNAL, 2021). 

By the other hand, the Shapiro-Wilks test poses the null hypothesis that a sample comes from a normal distribution. The Shapiro-Wilks test poses the null hypothesis that a sample comes from a normal distribution. This test attempts to reject the null hypothesis according to the level of significance. Therefore, if the significance is greater than 0.05, the null hypothesis is overcome, and if it is less than this value, the alternate hypothesis is accepted and it could then be stated that the data do not follow a normal distribution (UNAL, 2021).

It is important to highlight that the study of beneficial microorganisms to create new biological formulations for plant protection is typically conducted under the same ecological and geographical conditions in which the microorganisms were isolated. Thus, effect of this bacteria has been demonstrated as a biological control in crops such as tomato and in specific conditions. However, its potential use as a pesticide in potatoes and raspberries is unknown. The main objective of this work was to demonstrate the potential effect of *B. velezensis* strains against *R. solani*, as a biological control in raspeberry and potatoa and its potential effect on potato crop growth. The strains were isolated in southern Russia on suppressing *Rhizoctonia* disease on potato and spur blight on red raspberry in Western Siberia, which is a geographically distant region with much more severe climate conditions (Asaturova *et al*., 2020).

For this, different experiments and scenarios were carried out. Thus, the potential effect was measured through the antifungal activity of *B. velezensis* against *R. solani* *in vitro*, by applying different treatments in different proportions (quantity) of colony units. The evaluation of the effect of *B. velezensis* strains on the incidence and severity of the disease was evaluated through morphometric parameters caused by *R. solani* in two potato cultivars differentiated by resistance to the disease, during the growing seasons 2015 and 2016 in Western Siberia. Finally, to test the potential increase in potato crop, the biomass distribution of the daughter tubers of two potato cultivars and the total yield were measured during the 2015 and 2016 growing seasons in Western Siberia.

The diameter of the colonies (cm) was measured at 3, 5 and 7 days for *R. solani* and *D. applanata* under the application of the strains: *Bacillus velezensis* BZR 336g and BZR 517 at three different concentrations: 10^4, 10^5 and 10^6 CFU/ml. Disease incidence and severity was measured in percentage in the years 2015 and 2016, in three different treatments: control, BZR 336 g strain and BZR 517 strain, at weeks 4, 6 and 10 after sowing.

Morphometric parameters of two different cultivars (Svitanok kievskiy and Yuna) were measured, such as the total height of the plants (cm) and the number of stems developed with the same factors and levels previously mentioned.

In these same two cultivars the biomass distribution by fractions was measured, in order to measure the plant grow capacity, and they were divided in tree fraction categories: small (less than 35 g), medium (36â€“180 g), or large (more than 180 g). Yields were determined by weighing all daughter tubers from each plot in the both years. For statistical tests, all data were analyzed performing Duncan and Tukey tests.


## Objectives

Demonstrate the potential effect of *B. velezensis* strains  against *R. solani* as a biological control, and a potential increasement in the plant growth of potato. 

Also in this review, the aim of this group is to compare the analysis done in the article between the Duncan and Turkey tests to understand why Duncan was used in the article.


## Hypothesis

*B. velezensis* strains can be used as biological control agents against *R. solani*, and increase significantly the plant growth of potato. Moreover, there is no significant difference between the results obtained through the Duncan and Turkey test.

## Methods


**1. Dowload Data:**
First, dowload the raw data of the paper that is in the link: 
<https://dfzljdn9uc3pi.cloudfront.net/2021/11578/1/peerj-55829-Raw_data.xls>

**Article:**  <https://peerj.com/articles/11578/#>

```{r} 
if(!dir.exists("data")) dir.create("data")
# download.file("https://dfzljdn9uc3pi.cloudfront.net/2021/11578/1/peerj-55829-Raw_data.xls",
#               "data/rawdata.xls")
```

**2. Open and Arrange Data:** For this step, it was used the package "Readxl" to charge the excel file. Each sheet of excel was opened indicating its name and the range required. In some sheets it was use the function "fill" to fill the cells that were empty. Also some names of variables were changed with "rename" and "pivot longer" was used to increase the number of rows or to decrease the number of columns.The potence format was changed. Finally, some new sheets were created why others where joined or deleted in order to have the data arranged. 


```{r,results='hide',message=FALSE, warning=FALSE}
library(readxl)
#Open sheets with ranges 
AntagonisticActivity <-
  read_excel("data/peerj-55829-Raw_data.xls",
             sheet = "Antagonistic activity",
             range = "A3:E38")
DiseaseIncidenceAndSeverity <- read_excel("data/peerj-55829-Raw_data.xls",
                                          sheet = "disease incidence and severity",
                                          range = "A4:N40")
MorphometricCharactOfPotato <- read_excel("data/peerj-55829-Raw_data.xls",
                                          sheet = "morphometric charact of potato",)
BiomassDistribution <- read_excel("data/peerj-55829-Raw_data.xls",sheet = "biomass distribution")
YieldOfPotato <- read_excel("data/peerj-55829-Raw_data.xls",
                            sheet = "yield of potato",
                            range = "B3:I15")
#Fill 
library(tidyr)
library(dplyr)
AntagonisticActivity <- AntagonisticActivity %>% fill(everything(), .direction = "down")
BiomassDistribution <- BiomassDistribution %>% fill(everything(), .direction = "down")
DiseaseIncidenceAndSeverity <- DiseaseIncidenceAndSeverity %>% fill(everything(), .direction = "down")
MorphometricCharactOfPotato <- MorphometricCharactOfPotato %>% fill(everything(), .direction = "down")
YieldOfPotato <- YieldOfPotato %>% fill(everything(), .direction = "down")

#Rename 
library(dplyr)
names(AntagonisticActivity)[names(AntagonisticActivity) == 'strain'] <- "Strain"
names(AntagonisticActivity)[names(AntagonisticActivity) == 'CFU/ml'] <- "Concentration"

#Pivot longer 
AntagonisticActivity <- pivot_longer(AntagonisticActivity,cols= c("3d", "5d", "7d"), names_to="Days", values_to="Colony.Diameter")

#Change potence
AntagonisticActivity$Concentration
a <- as.numeric(substr(AntagonisticActivity$Concentration, 1, 2))
b <- as.numeric(substr(AntagonisticActivity$Concentration, 3, 3))
a^b
AntagonisticActivity$Concentration <- a^b
rm(a,b)

#Create new column for treatments
AntagonisticActivity$Trat <- paste(AntagonisticActivity$Strain,AntagonisticActivity$Concentration)

#Rename days
library(dplyr)
AntagonisticActivity$Days<-gsub("d","",as.character(AntagonisticActivity$Days))

#Join data frame 
library(dplyr)
Data.Cultivars <- full_join(MorphometricCharactOfPotato, DiseaseIncidenceAndSeverity, by = c("Cultivar","Year", "Treatment","Weeks after planting"))

#Rename 
library(dplyr)
names(Data.Cultivars)[names(Data.Cultivars) == 'Plant height, cm'] <- "1"
names(Data.Cultivars)[names(Data.Cultivars) == '...6.x'] <- "2"
names(Data.Cultivars)[names(Data.Cultivars) == '...7.x'] <- "3"
names(Data.Cultivars)[names(Data.Cultivars) == '...8.x'] <- "4"
names(Data.Cultivars)[names(Data.Cultivars) == '...9.x'] <- "5"

#Pivot longer 
Data.Cultivars <- pivot_longer(Data.Cultivars,cols= c("1", "2", "3","4","5"), names_to="Rep", values_to="Plant.Height")

#Create empty new columns 
Data.Cultivars$Disease.Incidence <- NA
Data.Cultivars$Disease.Severity <- NA
Data.Cultivars$Stems <- NA

#Add data to the columns 
variables <- c("Disease incidence, %","...6.y","...7.y","...8.y","...9.y")
for (i in 1:5) {
  A <- Data.Cultivars$Rep==i
  Data.Cultivars$Disease.Incidence[A] <- Data.Cultivars[[variables[i]]][A]
}

Data.Cultivars$Stems <- NA
variables1 <- c("The number of stems per plant","...11.x","...12.x","...13.x","...14.x")
for (i in 1:5) {
  A1 <- Data.Cultivars$Rep==i
  Data.Cultivars$Stems[A1] <- Data.Cultivars[[variables1[i]]][A1]
}

Data.Cultivars$Disease.Severity <- NA
variables1 <- c("Disease severity, %","...11.y","...12.y","...13.y","...14.y")
for (i in 1:5) {
  A2 <- Data.Cultivars$Rep==i
  Data.Cultivars$Disease.Severity[A2] <- Data.Cultivars[[variables1[i]]][A2]
}


#New Dataframe with variables that I need 
namesdatacultivar <- c("Cultivar","Treatment","Year","Weeks after planting", "Rep","Plant.Height","Disease.Incidence","Disease.Severity","Stems")           
Data.Cultivars.Final <- Data.Cultivars [which(names(Data.Cultivars) %in% namesdatacultivar)]

#Yieldofpotato 
#Rename 
library(dplyr)
names(YieldOfPotato)[names(YieldOfPotato) == 'Yield, t ha-1'] <- "1"
names(YieldOfPotato)[names(YieldOfPotato) == '...5'] <- "2"
names(YieldOfPotato)[names(YieldOfPotato) == '...6'] <- "3"
names(YieldOfPotato)[names(YieldOfPotato) == '...7'] <- "4"
names(YieldOfPotato)[names(YieldOfPotato) == '...8'] <- "5"
#Pivot longer 
YieldOfPotato <- pivot_longer(YieldOfPotato,cols= c("1", "2", "3","4","5"), names_to="Rep", values_to="Yield.Potato")

#BiomassDistribution
#Rename 
library(dplyr)
names(BiomassDistribution)[names(BiomassDistribution) == 'Biomass distribution by fractions, %'] <- "1"
names(BiomassDistribution)[names(BiomassDistribution) == '...6'] <- "2"
names(BiomassDistribution)[names(BiomassDistribution) == '...7'] <- "3"
names(BiomassDistribution)[names(BiomassDistribution) == '...8'] <- "4"
names(BiomassDistribution)[names(BiomassDistribution) == '...9'] <- "5"
#Pivot longer 
BiomassDistribution <- pivot_longer(BiomassDistribution,cols= c("1", "2", "3","4","5"), names_to="Rep", values_to="Percentage.Biomass")

#Create a sheet for medium fraction
medium.fraction <- BiomassDistribution[BiomassDistribution$Fractions=="medium",]

#Join sheets of yield and medium fraction
names(YieldOfPotato)[names(YieldOfPotato) == 'Bacillus strain'] <- "Treatment"
YieldOfPotato <- full_join(YieldOfPotato,medium.fraction)
YieldOfPotato <- YieldOfPotato[,-which(names(YieldOfPotato)=="Fractions")]

#Remove unnecessary sheets
ls()
rm("Data.Cultivars","DiseaseIncidenceAndSeverity","medium.fraction","MorphometricCharactOfPotato")

```


**3. Do analysis:**
Finally with the arrangement of the sheets of excel, there were obtained 4 main data sets. The first one was Antagonistic Activity, then Data Cultivars that include the variables of Percentage of Disease Incidence, Percentage of Disease Severity, Plant height and number of stems per plant.Then, the data set of Biomass Distribution and finally the data set of Yield of Potato. 

With these data sets were performed Tukey HSD Test, Duncan test, Kruskal and Normality Test of Residuals with shapiro Test. All results were expressed in graphs using the packages of "ggplot" and "ggpubr". The results were analyzed and compared with the results of the article. It is important to say that in the article, the authors have only performed Duncan Test.

**Description of data sets:**

**1) Effect of *B. velezensis* strains on disease incidence and severity and morphometric parameters caused by *R. solani* on two potato cultivars differed by disease resistance during 2015 and 2016 growing seasons in Western Siberia**


Cultivars:

1. Svitanok kievskiy 

2. Yuna


Years:

* 2015

* 2016


Treatments:

1. Control

2. BZR 336g 

3. BZR 517


Weeks after planting:

* 4

* 6

* 10


Variables: (5 rep/treatment)

1. Disease incidence (%) 

2. Disease severity (%)

3. Plant height (cm) 

4. Number of stems per plant


&nbsp;

**2) Effect of *B. velezens* strains on the biomass distribution of daughter tubers of two potato cultivars differed by disease resistance to *R. solani* and total yield during 2015 and 2016 growing seasons in Western Siberia.**


Cultivars:

1. Svitanok kievskiy 

2. Yuna


Years: 

* 2015

* 2016


Treatments:

1. Control 

2. BZR 336g

3. BZR 517


Fractions:

* Small

* Medium

* Large 


Variables: (5 rep/treatment)

1. Biomass distribution 

**3) Antifungal activity of *B. velezensis* against *R solani* in vitro.** 


Treatments:
 
1. 10^4 CFU/mL
  
2. 10^5 CFU/mL
  
3. 10^6 CFU/mL
  
4. Control.

* CFU: Colony-Forming Unit


Days:

* 3

* 5

* 7 

Variables: 

* Colony Diameter (cm)
* Strains 


&nbsp;

## Results and Discussion 


&nbsp;

**1) Effect of *B. velezensis* strains on disease incidence and severity and morphometric parameters caused by *R. solani* on two potato cultivars differed by disease resistance during 2015 and 2016 growing seasons in Western Siberia**


&nbsp;
**1.1 Plant Height**

The Duncan and Tukey tests had few differences.Only in year 2016, week 6 in cultivar Svitanok kievski it can be seen a difference in the group of BZR 517 (Figures 1 and 2). The Shapiro-Wilk normality test was performed for Anova and Square Root Anova because in Anova p was lower than 0.05, that means that the data significantly deviate from a normal distribution (Figure 3).

Taking into account the plant height, at week 10, we can see that the BZR 336g treatment generated greater plant height in every cultivar and year in the Ducan test, less in the cultivar Svitanok Kievski in 2016, when there was no significant difference between treatments. In the Tukey test, the difference between treatments was significant only in the Yuna variety.


```{r,results='hide', warning=FALSE}
#Duncan Analysis Data.Cultivars.Final
library(agricolae)
library(ggplot2)
library(ggpubr)

# Plant Height

#Anova Plant Height
model<-aov(Plant.Height~Treatment+`Weeks after planting`+Year, data=Data.Cultivars.Final)
summary(model)
Data.Cultivars.Final$`Weeks after planting` <- factor(Data.Cultivars.Final$`Weeks after planting`)

## Plant Height Duncan 

Y <- W <- Tr <- L <- C <- M <- numeric()

for (i in 2015:2016) { 
  for (k in levels(as.factor(Data.Cultivars.Final$Cultivar))) {
    for(j in levels(Data.Cultivars.Final$`Weeks after planting`)) {
      d1 <- Data.Cultivars.Final[Data.Cultivars.Final$Year==i & 
                                   Data.Cultivars.Final$`Weeks after planting`==j &
                                   Data.Cultivars.Final$Cultivar==k, ]
      model <- aov(Plant.Height~Treatment, data=d1)
      summary(model)
      DT <- duncan.test(model, "Treatment", console = TRUE)
      Y <- c(Y, i,i,i)
      W <- c(W, j,j,j)
      C <- c(C, k,k,k)
      Tr <- c(Tr, row.names(DT$groups))
      L <- c(L, DT$groups$groups)
      M <- c(M, DT$groups$Plant.Height)
    } 
  }
}


LettersPH <- data.frame(Year = Y, `Weeks after planting` = factor(W), 
                        Cultivar = C, Treatment = factor(Tr), letra = L, mea = M)

## Plant Height Tukey 

Y <- W <- Tr <- L <- C <- M <- numeric()

for (i in 2015:2016) { 
  for (k in levels(as.factor(Data.Cultivars.Final$Cultivar))) {
    for(j in levels(Data.Cultivars.Final$`Weeks after planting`)) {
      d1z <- Data.Cultivars.Final[Data.Cultivars.Final$Year==i & 
                                    Data.Cultivars.Final$`Weeks after planting`==j &
                                    Data.Cultivars.Final$Cultivar==k, ]
      model <- aov(Plant.Height~Treatment, data=d1z)
      summary(model)
      DT <- HSD.test(model, "Treatment", console = TRUE)
      Y <- c(Y, i,i,i)
      W <- c(W, j,j,j)
      C <- c(C, k,k,k)
      Tr <- c(Tr, row.names(DT$groups))
      L <- c(L, DT$groups$groups)
      M <- c(M, DT$groups$Plant.Height)
    } 
  }
}

LettersPHz <- data.frame(Year = Y, `Weeks after planting` = factor(W), 
                         Cultivar = C, Treatment = factor(Tr), letra = L, mea = M)

#Plant Height Kruskal  

Y <- W <- Tr <- L <- C <- M <- numeric()

for (i in 2015:2016) { 
  for (k in levels(as.factor(Data.Cultivars.Final$Cultivar))) {
    for(j in levels(Data.Cultivars.Final$`Weeks after planting`)) {
      d1k <- Data.Cultivars.Final[Data.Cultivars.Final$Year==i & 
                                    Data.Cultivars.Final$`Weeks after planting`==j &
                                    Data.Cultivars.Final$Cultivar==k, ]
      d1k$Treatment <- factor(d1k$Treatment)
      kw <- with(d1k,kruskal(Plant.Height,Treatment))
      gr <- kw$groups
      lt <- gr$groups[order(row.names(gr))]
      Y <- c(Y, i,i,i)
      W <- c(W, j,j,j)
      C <- c(C, k,k,k)
      Tr <- c(Tr, levels(d1k$Treatment))
      L <- c(L, lt)
      M <- c(M, mean(d1k$Plant.Height[d1k$Treatment == levels(d1k$Treatment)[1]]),
             mean(d1k$Plant.Height[d1k$Treatment == levels(d1k$Treatment)[2]]),
             mean(d1k$Plant.Height[d1k$Treatment == levels(d1k$Treatment)[3]]))
    }
  }
}

LettersPHk <- data.frame(Year = Y, `Weeks after planting` = factor(W), 
                         Cultivar = C, Treatment = factor(Tr), letra = L, mea = M)


```

```{r Figure 1. Results of Duncan Test in the variable of Plant Height on potato (cm)}
library(agricolae)
library(ggplot2)
library(ggpubr)
#Plant Height Duncan Graph

ggplot(Data.Cultivars.Final, aes(x=`Weeks after planting`, y=Plant.Height, fill=Treatment))+ylab("Plant Height (cm)")+
  geom_boxplot()+
  facet_grid(Cultivar~Year)+
  theme_light()+
  geom_text(data = LettersPH,
            mapping = aes(x = Weeks.after.planting,
                          y = mea + 5,
                          label = letra),
            position = position_dodge(0.9))+
  labs(caption = "Figure 1. Results of Duncan Test in the variable of Plant Height on potato (cm)") +
  theme(plot.caption.position = "plot",
        plot.caption = element_text(hjust = 0))
```

```{r Figure 2. Results of Tukey Test in the variable of Plant Height on potato (cm)}
#Plant Height Tukey Graph

ggplot(Data.Cultivars.Final, aes(x=`Weeks after planting`, y=Plant.Height, fill=Treatment))+ylab("Plant Height (cm)")+
  geom_boxplot()+
  facet_grid(Cultivar~Year)+
  theme_light()+
  geom_text(data = LettersPHz,
            mapping = aes(x = Weeks.after.planting,
                          y = mea + 5,
                          label = letra),
            position = position_dodge(0.9))+
  labs(caption = "Figure 2. Results of Tukey Test in the variable of Plant Height on potato (cm)") +
  theme(plot.caption.position = "plot",
        plot.caption = element_text(hjust = 0))
```

```{r Figure 3. Results of Kruskal Test in the variable of Plant Height on potato (cm}
ggplot(Data.Cultivars.Final, aes(x=`Weeks after planting`, y=Plant.Height, fill=Treatment))+ylab("Plant Height (cm)")+
  geom_boxplot()+
  facet_grid(Cultivar~Year)+
  theme_light()+
  geom_text(data = LettersPHk,
            mapping = aes(x = Weeks.after.planting,
                          y = mea + 5,
                          label = letra),
            position = position_dodge(0.9))+
  labs(caption = "Figure 3. Results of Kruskal Test in the variable of Plant Height on potato (cm)") +
  theme(plot.caption.position = "plot",
        plot.caption = element_text(hjust = 0))
```


```{r Figure 4. Normality of Residuals Plant Height}
#Residuals Plant Height 
anova.ph<-aov(Plant.Height~Treatment+`Weeks after planting`+Year, data=Data.Cultivars.Final) #anova 
anova.ph.sqrt <- aov(sqrt(Plant.Height)~Treatment+`Weeks after planting`+Year, data=Data.Cultivars.Final) #square root 
shapiro.test(anova.ph$residuals) #0.0329 anormal 
shapiro.test(anova.ph.sqrt$residuals) #0.02933
par(mfrow = c(1, 2), oma = c(0, 0, 1.1, 0))
plot(anova.ph, main = "ANOVA", which = 2, ask = F,sub.caption = "")
plot(anova.ph.sqrt, main = "Square Root ANOVA", which = 2, ask = F,sub.caption = "")
```
<font size="1"> Figure 4. Normality of Residuals Plant Height</font> 

```{r}
#AIC and BIC Plant Height
AIC(anova.ph, anova.ph.sqrt)
BIC(anova.ph, anova.ph.sqrt)
```
&nbsp;

**1.2 Disease Incidence** 

The Duncan and Tukey tests had few differences.Only in year 2015 in cultivar Svitanok kievski it can be seen a difference between the groups (Figures 4 and 5). The Shapiro-Wilk normality test was performed for Anova and Square Root Anova because in Anova p was lower than 0.05, that means that the data significantly deviate from a normal distribution (Figure 6). 

Taking into account the incidence of the disease, at week 10, we can observe that the BZR 336 treatment was the one that caused the lowest incidence in both years and in both cultivars when using the Duncan test. In the Tukey test, this difference was not significant between treatments on cultivar Svitanok kievski in 2015.


```{r,results='hide'}
#Disease Incidence
#Anova Disease Incidence 
model<-aov(Disease.Incidence~Treatment+`Weeks after planting`+Year, data=Data.Cultivars.Final)
summary(model)
Data.Cultivars.Final$`Weeks after planting` <- factor(Data.Cultivars.Final$`Weeks after planting`)


#Duncan Test Disease Incidence

Y <- W <- Tr <- L <- C <- M <- numeric()

for (i in 2015:2016) { 
  for (k in levels(as.factor(Data.Cultivars.Final$Cultivar))) {
    for(j in levels(Data.Cultivars.Final$`Weeks after planting`)) {
      d1 <- Data.Cultivars.Final[Data.Cultivars.Final$Year==i & 
                                   Data.Cultivars.Final$`Weeks after planting`==j &
                                   Data.Cultivars.Final$Cultivar==k, ]
      model <- aov(Disease.Incidence~Treatment, data=d1)
      summary(model)
      DT <- duncan.test(model, "Treatment", console = TRUE)
      Y <- c(Y, i,i,i)
      W <- c(W, j,j,j)
      C <- c(C, k,k,k)
      Tr <- c(Tr, row.names(DT$groups))
      L <- c(L, DT$groups$groups)
      M <- c(M, DT$groups$Disease.Incidence)
    } 
  }
}


LettersDI <- data.frame(Year = Y, `Weeks after planting` = factor(W), 
                        Cultivar = C, Treatment = factor(Tr), letra = L, mea = M)

#Tukey Disease Incidence

Y <- W <- Tr <- L <- C <- M <- numeric()

for (i in 2015:2016) { 
  for (k in levels(as.factor(Data.Cultivars.Final$Cultivar))) {
    for(j in levels(Data.Cultivars.Final$`Weeks after planting`)) {
      d1z <- Data.Cultivars.Final[Data.Cultivars.Final$Year==i & 
                                    Data.Cultivars.Final$`Weeks after planting`==j &
                                    Data.Cultivars.Final$Cultivar==k, ]
      model <- aov(Disease.Incidence~Treatment, data=d1z)
      summary(model)
      DT <- HSD.test(model, "Treatment", console = TRUE)
      Y <- c(Y, i,i,i)
      W <- c(W, j,j,j)
      C <- c(C, k,k,k)
      Tr <- c(Tr, row.names(DT$groups))
      L <- c(L, DT$groups$groups)
      M <- c(M, DT$groups$Disease.Incidence)
    } 
  }
}


LettersDIz <- data.frame(Year = Y, `Weeks after planting` = factor(W), 
                         Cultivar = C, Treatment = factor(Tr), letra = L, mea = M)

#Disease Incidence Kruskal  

Y <- W <- Tr <- L <- C <- M <- numeric()

for (i in 2015:2016) { 
  for (k in levels(as.factor(Data.Cultivars.Final$Cultivar))) {
    for(j in levels(Data.Cultivars.Final$`Weeks after planting`)) {
      d1k <- Data.Cultivars.Final[Data.Cultivars.Final$Year==i & 
                                    Data.Cultivars.Final$`Weeks after planting`==j &
                                    Data.Cultivars.Final$Cultivar==k, ]
      d1k$Treatment <- factor(d1k$Treatment)
      kw <- with(d1k,kruskal(Disease.Incidence,Treatment))
      gr <- kw$groups
      lt <- gr$groups[order(row.names(gr))]
      Y <- c(Y, i,i,i)
      W <- c(W, j,j,j)
      C <- c(C, k,k,k)
      Tr <- c(Tr, levels(d1k$Treatment))
      L <- c(L, lt)
      M <- c(M, mean(d1k$Disease.Incidence[d1k$Treatment == levels(d1k$Treatment)[1]]),
             mean(d1k$Disease.Incidence[d1k$Treatment == levels(d1k$Treatment)[2]]),
             mean(d1k$Disease.Incidence[d1k$Treatment == levels(d1k$Treatment)[3]]))
    }
  }
}

LettersDIk <- data.frame(Year = Y, `Weeks after planting` = factor(W), 
                         Cultivar = C, Treatment = factor(Tr), letra = L, mea = M)

```

```{r Figure 5. Results of Duncan Test in the variable of Disease Incidence}
#Duncan Graph Disease Incidence
ggplot(Data.Cultivars.Final, aes(x=`Weeks after planting`, y=Disease.Incidence, fill=Treatment))+ylab("Disease Incidence(%)")+
  geom_boxplot()+
  facet_grid(Cultivar~Year)+
  theme_light()+
  geom_text(data = LettersDI,
            mapping = aes(x = Weeks.after.planting,
                          y = mea + 8,
                          label = letra),
            position = position_dodge(0.9))+
  labs(caption = "Figure 5. Results of Duncan Test in the variable of Disease Incidence (%)") +
  theme(plot.caption.position = "plot",
        plot.caption = element_text(hjust = 0))
```


```{r Figure 6. Results of Tukey Test in the variable of Disease Incidence}
#Tukey Graph Disease Incidence
library(ggplot2)
ggplot(Data.Cultivars.Final, aes(x=`Weeks after planting`, y=Disease.Incidence, fill=Treatment))+ylab("Disease Incidence(%)")+
  geom_boxplot()+
  facet_grid(Cultivar~Year)+
  theme_light()+
  geom_text(data = LettersDIz,
            mapping = aes(x = Weeks.after.planting,
                          y = mea + 8,
                          label = letra),
            position = position_dodge(0.9))+
  labs(caption = "Figure 6. Results of Tukey Test in the variable of Disease Incidence (%)") +
  theme(plot.caption.position = "plot",
        plot.caption = element_text(hjust = 0))
```

```{r Figure 7. Results of Kruskal Test in the variable of Disease Incidence on potato (cm)}
#Disease Incidence Kruskal Graph

ggplot(Data.Cultivars.Final, aes(x=`Weeks after planting`, y=Disease.Incidence, fill=Treatment))+ylab("Disease Incidence(%)")+
  geom_boxplot()+
  facet_grid(Cultivar~Year)+
  theme_light()+
  geom_text(data = LettersDIk,
            mapping = aes(x = Weeks.after.planting,
                          y = mea + 5,
                          label = letra),
            position = position_dodge(0.9))+
  labs(caption = "Figure 7. Results of Kruskal Test in the variable of Disease Incidence on potato (cm)") +
  theme(plot.caption.position = "plot",
        plot.caption = element_text(hjust = 0))
```

```{r Figure 8. Normality of Residuals Disease Incidence}
#Residuals Disease Incidence
anova.di<-aov(Disease.Incidence~Treatment+`Weeks after planting`+Year, data=Data.Cultivars.Final) #anova 
anova.di.sqrt <- aov(sqrt(Disease.Incidence)~Treatment+`Weeks after planting`+Year, data=Data.Cultivars.Final) #square root 
shapiro.test(anova.di$residuals) #0.03132 anormal 
shapiro.test(anova.di.sqrt$residuals) #0.001165
par(mfrow = c(1, 2), oma = c(0, 0, 1.1, 0))
plot(anova.di, main = "ANOVA", which = 2, ask = F,sub.caption = "")
plot(anova.di.sqrt, main = "Square Root ANOVA", which = 2, ask = F,sub.caption = "")
```

<font size="1"> Figure 8. Normality of Residuals Disease Incidence</font>

```{r}
#AIC and BIC Disease Incidence 
AIC(anova.di, anova.di.sqrt)
BIC(anova.di, anova.di.sqrt)
```
**1.3 Disease Severity**

The Duncan and Tukey tests did not have differences (Figures 7 and 8). The Shapiro-Wilk normality test was performed for Anova and Square Root Anova because in Anova p was lower than 0.05, that means that the data significantly deviate from a normal distribution (Figure 9).

Taking into account the disease severity, at week 10, we can observe that the BZR 336 treatment was the one that caused the lowest severity in both years and in both cultivars in both tests. However, this difference was not significant between the two treatments on cultivar Svitanok kievski in 2015, in both tests.

```{r,results='hide'}
#Disease Severity

#Anova Disease Severity
model<-aov(Disease.Severity~Treatment+`Weeks after planting`+Year, data=Data.Cultivars.Final)
summary(model)
Data.Cultivars.Final$`Weeks after planting` <- factor(Data.Cultivars.Final$`Weeks after planting`)
#Disease Severity Duncan Test

Y <- W <- Tr <- L <- C <- M <- numeric()

for (i in 2015:2016) { 
  for (k in levels(as.factor(Data.Cultivars.Final$Cultivar))) {
    for(j in levels(Data.Cultivars.Final$`Weeks after planting`)) {
      d1 <- Data.Cultivars.Final[Data.Cultivars.Final$Year==i & 
                                   Data.Cultivars.Final$`Weeks after planting`==j &
                                   Data.Cultivars.Final$Cultivar==k, ]
      model <- aov(Disease.Severity~Treatment, data=d1)
      summary(model)
      DT <- duncan.test(model, "Treatment", console = TRUE)
      Y <- c(Y, i,i,i)
      W <- c(W, j,j,j)
      C <- c(C, k,k,k)
      Tr <- c(Tr, row.names(DT$groups))
      L <- c(L, DT$groups$groups)
      M <- c(M, DT$groups$Disease.Severity)
    } 
  }
}


LettersDS <- data.frame(Year = Y, `Weeks after planting` = factor(W), 
                        Cultivar = C, Treatment = factor(Tr), letra = L, mea = M)

#Tukey Test Disease Severity

Y <- W <- Tr <- L <- C <- M <- numeric()

for (i in 2015:2016) { 
  for (k in levels(as.factor(Data.Cultivars.Final$Cultivar))) {
    for(j in levels(Data.Cultivars.Final$`Weeks after planting`)) {
      d1z <- Data.Cultivars.Final[Data.Cultivars.Final$Year==i & 
                                    Data.Cultivars.Final$`Weeks after planting`==j &
                                    Data.Cultivars.Final$Cultivar==k, ]
      model <- aov(Disease.Severity~Treatment, data=d1z)
      summary(model)
      DT <- HSD.test(model, "Treatment", console = TRUE)
      Y <- c(Y, i,i,i)
      W <- c(W, j,j,j)
      C <- c(C, k,k,k)
      Tr <- c(Tr, row.names(DT$groups))
      L <- c(L, DT$groups$groups)
      M <- c(M, DT$groups$Disease.Severity)
    } 
  }
}


LettersDSz <- data.frame(Year = Y, `Weeks after planting` = factor(W), 
                         Cultivar = C, Treatment = factor(Tr), letra = L, mea = M)

#Disease Severity Kruskal  

Y <- W <- Tr <- L <- C <- M <- numeric()

for (i in 2015:2016) { 
  for (k in levels(as.factor(Data.Cultivars.Final$Cultivar))) {
    for(j in levels(Data.Cultivars.Final$`Weeks after planting`)) {
      d1k <- Data.Cultivars.Final[Data.Cultivars.Final$Year==i & 
                                    Data.Cultivars.Final$`Weeks after planting`==j &
                                    Data.Cultivars.Final$Cultivar==k, ]
      d1k$Treatment <- factor(d1k$Treatment)
      kw <- with(d1k,kruskal(Disease.Severity,Treatment))
      gr <- kw$groups
      lt <- gr$groups[order(row.names(gr))]
      Y <- c(Y, i,i,i)
      W <- c(W, j,j,j)
      C <- c(C, k,k,k)
      Tr <- c(Tr, levels(d1k$Treatment))
      L <- c(L, lt)
      M <- c(M, mean(d1k$Disease.Severity[d1k$Treatment == levels(d1k$Treatment)[1]]),
             mean(d1k$Disease.Severity[d1k$Treatment == levels(d1k$Treatment)[2]]),
             mean(d1k$Disease.Severity[d1k$Treatment == levels(d1k$Treatment)[3]]))
    }
  }
}

LettersDSk <- data.frame(Year = Y, `Weeks after planting` = factor(W), 
                         Cultivar = C, Treatment = factor(Tr), letra = L, mea = M)

```

```{r Figure 9. Results of Duncan Test in the variable of Disease Severity}
#Duncan Graph Disease Severity
ggplot(Data.Cultivars.Final, aes(x=`Weeks after planting`, y=Disease.Severity, fill=Treatment))+ylab("Disease Severity (%)")+
  geom_boxplot()+
  facet_grid(Cultivar~Year)+
  theme_light()+
  geom_text(data = LettersDS,
            mapping = aes(x = Weeks.after.planting,
                          y = mea + 5,
                          label = letra),
            position = position_dodge(0.9))+
  labs(caption = "Figure 9. Results of Duncan Test in the variable of Disease Severity (%)") +
  theme(plot.caption.position = "plot",
        plot.caption = element_text(hjust = 0))
```


```{r Figure 10. Results of Tukey Test in the variable of Disease Severity}
#Tukey Graph Disease Severity

ggplot(Data.Cultivars.Final, aes(x=`Weeks after planting`, y=Disease.Severity, fill=Treatment))+ylab("Disease Severity(%)")+
  geom_boxplot()+
  facet_grid(Cultivar~Year)+
  theme_light()+ 
  geom_text(data = LettersDSz,
            mapping = aes(x = Weeks.after.planting,
                          y = mea + 7,
                          label = letra),
            position = position_dodge(0.9))+
  labs(caption = "Figure 10. Results of Tukey Test in the variable of Disease Severity (%)") +
  theme(plot.caption.position = "plot",
        plot.caption = element_text(hjust = 0))
```

```{r Figure 11. Results of Kruskal Test in the variable of Disease Severity on potato}
#Disease Severity Kruskal Graph

ggplot(Data.Cultivars.Final, aes(x=`Weeks after planting`, y=Disease.Severity, fill=Treatment))+ylab("Disease Severity(%)")+
  geom_boxplot()+
  facet_grid(Cultivar~Year)+
  theme_light()+
  geom_text(data = LettersDSk,
            mapping = aes(x = Weeks.after.planting,
                          y = mea + 5,
                          label = letra),
            position = position_dodge(0.9))+
  labs(caption = "Figure 11. Results of Kruskal Test in the variable of Disease Severity on potato (%)") +
  theme(plot.caption.position = "plot",
        plot.caption = element_text(hjust = 0))

```

```{r Figure 12. Normality of Residuals Disease Severity}
#Residuals Disease Severity
anova.ds<-aov(Disease.Severity~Treatment+`Weeks after planting`+Year, data=Data.Cultivars.Final) #anova 
anova.ds.sqrt <- aov(sqrt(Disease.Severity)~Treatment+`Weeks after planting`+Year, data=Data.Cultivars.Final) #square root 
shapiro.test(anova.ds$residuals) #0.002356 anormal  
shapiro.test(anova.ds.sqrt$residuals) #0.0009698
par(mfrow = c(1, 2), oma = c(0, 0, 1.1, 0))
plot(anova.ds, main = "ANOVA", which = 2, ask = F,sub.caption = "")
plot(anova.ds.sqrt, main = "Square Root ANOVA", which = 2, ask = F,sub.caption = "")

```

<font size="1"> Figure 12. Normality of Residuals Disease Severity</font>

```{r}
#AIC and BIC Disease Severity 
AIC(anova.ds, anova.ds.sqrt)
BIC(anova.ds, anova.ds.sqrt)
```

**1.4 Number of stems**

The Duncan and Tukey tests had few differences.Only in year 2016 in cultivar Yuna in the control it can be seen a difference between the groups (Figures 10 and 11). The Shapiro-Wilk normality test was performed for Anova and Square Root Anova because in Anova p was lower than 0.05, that means that the data significantly deviate from a normal distribution (Figure 12).

Taking into account the number of stems, at week 10, we can see that the BZR 336 treatment generated the highest number of stems in both years and in both cultivars in both tests. However, this difference was not significant between the two treatments on cultivar Yuna in 2015, in both tests.

```{r,results='hide'}
#Stems
#Anova Stems
model<-aov(Stems~Treatment+`Weeks after planting`+Year, data=Data.Cultivars.Final)
summary(model)
Data.Cultivars.Final$`Weeks after planting` <- factor(Data.Cultivars.Final$`Weeks after planting`)

#Ducant Test Stems
Y <- W <- Tr <- L <- C <- M <- numeric()

for (i in 2015:2016) { 
  for (k in levels(as.factor(Data.Cultivars.Final$Cultivar))) {
    for(j in levels(Data.Cultivars.Final$`Weeks after planting`)) {
      d1 <- Data.Cultivars.Final[Data.Cultivars.Final$Year==i & 
                                   Data.Cultivars.Final$`Weeks after planting`==j &
                                   Data.Cultivars.Final$Cultivar==k, ]
      model <- aov(Stems~Treatment, data=d1)
      summary(model)
      DT <- duncan.test(model, "Treatment", console = TRUE)
      Y <- c(Y, i,i,i)
      W <- c(W, j,j,j)
      C <- c(C, k,k,k)
      Tr <- c(Tr, row.names(DT$groups))
      L <- c(L, DT$groups$groups)
      M <- c(M, DT$groups$Stems)
    } 
  }
}


LettersST <- data.frame(Year = Y, `Weeks after planting` = factor(W), 
                        Cultivar = C, Treatment = factor(Tr), letra = L, mea = M)

#Tukey Graph Stems

Y <- W <- Tr <- L <- C <- M <- numeric()

for (i in 2015:2016) { 
  for (k in levels(as.factor(Data.Cultivars.Final$Cultivar))) {
    for(j in levels(Data.Cultivars.Final$`Weeks after planting`)) {
      d1z <- Data.Cultivars.Final[Data.Cultivars.Final$Year==i & 
                                    Data.Cultivars.Final$`Weeks after planting`==j &
                                    Data.Cultivars.Final$Cultivar==k, ]
      model <- aov(Stems~Treatment, data=d1z)
      summary(model)
      DT <- HSD.test(model, "Treatment", console = TRUE)
      Y <- c(Y, i,i,i)
      W <- c(W, j,j,j)
      C <- c(C, k,k,k)
      Tr <- c(Tr, row.names(DT$groups))
      L <- c(L, DT$groups$groups)
      M <- c(M, DT$groups$Stems)
    } 
  }
}


LettersSTz <- data.frame(Year = Y, `Weeks after planting` = factor(W), 
                         Cultivar = C, Treatment = factor(Tr), letra = L, mea = M)

#Stems Kruskal  

Y <- W <- Tr <- L <- C <- M <- numeric()

for (i in 2015:2016) { 
  for (k in levels(as.factor(Data.Cultivars.Final$Cultivar))) {
    for(j in levels(Data.Cultivars.Final$`Weeks after planting`)) {
      d1k <- Data.Cultivars.Final[Data.Cultivars.Final$Year==i & 
                                    Data.Cultivars.Final$`Weeks after planting`==j &
                                    Data.Cultivars.Final$Cultivar==k, ]
      d1k$Treatment <- factor(d1k$Treatment)
      kw <- with(d1k,kruskal(Stems,Treatment))
      gr <- kw$groups
      lt <- gr$groups[order(row.names(gr))]
      Y <- c(Y, i,i,i)
      W <- c(W, j,j,j)
      C <- c(C, k,k,k)
      Tr <- c(Tr, levels(d1k$Treatment))
      L <- c(L, lt)
      M <- c(M, mean(d1k$Stems[d1k$Treatment == levels(d1k$Treatment)[1]]),
             mean(d1k$Stems[d1k$Treatment == levels(d1k$Treatment)[2]]),
             mean(d1k$Stems[d1k$Treatment == levels(d1k$Treatment)[3]]))
    }
  }
}

LettersSTk <- data.frame(Year = Y, `Weeks after planting` = factor(W), 
                         Cultivar = C, Treatment = factor(Tr), letra = L, mea = M)

```

```{r Figure 13. Results of Duncan Test in the variable Number of Stems}
#Duncan Graph Stems 
ggplot(Data.Cultivars.Final, aes(x=`Weeks after planting`, y=Stems, fill=Treatment))+ylab("Number of Stems")+
  geom_boxplot()+ 
  facet_grid(Cultivar~Year)+
  theme_light()+
  geom_text(data = LettersST,
            mapping = aes(x = Weeks.after.planting,
                          y = mea + 1,
                          label = letra),
            position = position_dodge(0.9))+
  labs(caption = "Figure 13. Results of Duncan Test in the variable Number of Stems") +
  theme(plot.caption.position = "plot",
        plot.caption = element_text(hjust = 0))
```


```{r Figure 14. Results of Tukey Test in the variable Number of Stems}
#Tukey Graph Stems
ggplot(Data.Cultivars.Final, aes(x=`Weeks after planting`, y=Stems, fill=Treatment))+ylab("Number of Stems")+
  geom_boxplot()+ 
  facet_grid(Cultivar~Year)+
  theme_light()+
  geom_text(data = LettersSTz,
            mapping = aes(x = Weeks.after.planting,
                          y = mea + 1,
                          label = letra),
            position = position_dodge(0.9))+
  labs(caption = "Figure 14. Results of Tukey Test in the variable Number of Stems") +
  theme(plot.caption.position = "plot",
        plot.caption = element_text(hjust = 0))
```

```{r Figure 15. Results of Kruskal Test in the variable of Stems on potato (cm)}
#Stems Kruskal Graph

ggplot(Data.Cultivars.Final, aes(x=`Weeks after planting`, y=Stems, fill=Treatment))+ylab("Stems (cm)")+
  geom_boxplot()+
  facet_grid(Cultivar~Year)+
  theme_light()+
  geom_text(data = LettersSTk,
            mapping = aes(x = Weeks.after.planting,
                          y = mea + 1,
                          label = letra),
            position = position_dodge(0.9))+
  labs(caption = "Figure 15. Results of Kruskal Test in the variable of Stems on potato (cm)") +
  theme(plot.caption.position = "plot",
        plot.caption = element_text(hjust = 0))
```

```{r Figure 16. Normality of Residuals Stems}
#Residuals Stems
anova.st<-aov(Stems~Treatment+`Weeks after planting`+Year, data=Data.Cultivars.Final) #anova 
anova.st.sqrt <- aov(sqrt(Stems)~Treatment+`Weeks after planting`+Year, data=Data.Cultivars.Final) #square root 
shapiro.test(anova.st$residuals) #0.007876 anormal  
shapiro.test(anova.st.sqrt$residuals) #0.002167
par(mfrow = c(1, 2), oma = c(0, 0, 1.1, 0))
plot(anova.st, main = "ANOVA", which = 2, ask = F,sub.caption = "")
plot(anova.st.sqrt, main = "Square Root ANOVA", which = 2, ask = F,sub.caption = "")

```

<font size="1"> Figure 16. Normality of Residuals Stems</font>


```{r}
#AIC and BIC Stems
AIC(anova.st, anova.st.sqrt)
BIC(anova.st, anova.st.sqrt)
```

**2) Effect of *B. velezens* strains on the biomass distribution of daughter tubers of two potato cultivars differed by disease resistance to *R. solani* and total yield during 2015 and 2016 growing seasons in Western Siberia.**

**2.1 Biomass distribution**

The Duncan and Tukey tests did not have differences (Figures 13 and 14). The Shapiro-Wilk normality test was performed for Anova and Square Root Anova but this case in Anova p was higher than 0.05, that means that the data has a normal distribution (Figure 15).

Taking into account the biomass, in the medium fraction, we can observe that in both tests and in both years, in cultivar Svitanok kievski, the BZR 517 treatment generated the highest biomass. However, for cultivar Yuna, the difference between treatments and/or control was not significant.


```{r,results='hide'}
#Prueba Biomass
model<-aov(Percentage.Biomass~Treatment+`Fractions`+Year, data=BiomassDistribution)
summary(model)
BiomassDistribution$`Fractions` <- factor(BiomassDistribution$`Fractions`)

#Biomass Duncant Test
Y <- W <- Tr <- L <- C <- M <- numeric()

for (i in 2015:2016) { 
  for (k in levels(as.factor(BiomassDistribution$Cultivar))) {
    for(j in levels(BiomassDistribution$`Fractions`)) {
      d200 <- BiomassDistribution[BiomassDistribution$Year==i & 
                                   BiomassDistribution$`Fractions`==j &
                                   BiomassDistribution$Cultivar==k, ]
      model <- aov(Percentage.Biomass~Treatment, data=d200)
      summary(model)
      DT <- duncan.test(model, "Treatment", console = TRUE)
      Y <- c(Y, i,i,i)
      W <- c(W, j,j,j)
      C <- c(C, k,k,k)
      Tr <- c(Tr, row.names(DT$groups))
      L <- c(L, DT$groups$groups)
      M <- c(M, DT$groups$Percentage.Biomass)
    } 
  }
}

LettersPH1 <- data.frame(Year = Y, `Fractions` = factor(W), 
                         Cultivar = C, Treatment = factor(Tr), letra = L, mea = M)



#Prueba Biomass tukey 
library(agricolae)
Y <- W <- Tr <- L <- C <- M <- numeric()

for (i in 2015:2016) { 
  for (k in levels(as.factor(BiomassDistribution$Cultivar))) {
    for(j in levels(BiomassDistribution$`Fractions`)) {
      t200 <- BiomassDistribution[BiomassDistribution$Year==i & 
                                    BiomassDistribution$`Fractions`==j &
                                    BiomassDistribution$Cultivar==k, ]
      model <- aov(Percentage.Biomass~Treatment, data=t200)
      summary(model)
      DT <- HSD.test(model, "Treatment", console = TRUE)
      Y <- c(Y, i,i,i)
      W <- c(W, j,j,j)
      C <- c(C, k,k,k)
      Tr <- c(Tr, row.names(DT$groups))
      L <- c(L, DT$groups$groups)
      M <- c(M, DT$groups$Percentage.Biomass)
    } 
  }
}
LetterstPH11 <- data.frame(Year = Y, `Fractions` = factor(W), 
                           Cultivar = C, Treatment = factor(Tr), letra = L, mea = M)

#Biomass Kruskal  

Y <- W <- Tr <- L <- C <- M <- numeric()

for (i in 2015:2016) { 
  for (k in levels(as.factor(BiomassDistribution$Cultivar))) {
    for(j in levels(BiomassDistribution$`Fractions`)) {
      d1k <- BiomassDistribution[BiomassDistribution$Year==i & 
                                   BiomassDistribution$`Fractions`==j &
                                   BiomassDistribution$Cultivar==k, ]
      d1k$Treatment <- factor(d1k$Treatment)
      kw <- with(d1k,kruskal(Percentage.Biomass,Treatment))
      gr <- kw$groups
      lt <- gr$groups[order(row.names(gr))]
      Y <- c(Y, i,i,i)
      W <- c(W, j,j,j)
      C <- c(C, k,k,k)
      Tr <- c(Tr, levels(d1k$Treatment))
      L <- c(L, lt)
      M <- c(M, mean(d1k$Percentage.Biomass[d1k$Treatment == levels(d1k$Treatment)[1]]),
             mean(d1k$Percentage.Biomass[d1k$Treatment == levels(d1k$Treatment)[2]]),
             mean(d1k$Percentage.Biomass[d1k$Treatment == levels(d1k$Treatment)[3]]))
    }
  }
}

LettersPH12 <- data.frame(Year = Y, `Fractions` = factor(W), 
                         Cultivar = C, Treatment = factor(Tr), letra = L, mea = M)

```

```{r Figure 17.  Result of Duncan Test on the variable  Percentage of Biomass of potato}
#Biomass Graph Duncan 
ggplot(BiomassDistribution, aes(x=`Fractions`, y=Percentage.Biomass, fill=Treatment))+ylab("Biomass (%)")+
  geom_boxplot()+
  facet_grid(Cultivar~Year)+
  theme_light()+
  geom_text(data = LettersPH1,
            mapping = aes(x = Fractions,
                          y = mea + 8,
                          label = letra),
            position = position_dodge(0.9))+
  labs(caption = "Figure 17.  Result of Duncan Test on the variable  Percentage of Biomass of potato") +
  theme(plot.caption.position = "plot",
        plot.caption = element_text(hjust = 0))
```


```{r Figure 18. Result of Tukey Test in the variable Percentage of Biomass of potato}
#Biomass Graph Tukey 
ggplot(BiomassDistribution, aes(x=`Fractions`, y=Percentage.Biomass, fill=Treatment))+ ylab("Biomass (%)")+
  geom_boxplot()+
  facet_grid(Cultivar~Year)+
  theme_light()+
  geom_text(data = LetterstPH11,
            mapping = aes(x = Fractions,
                          y = mea + 8,
                          label = letra),
            position = position_dodge(0.9))+
  labs(caption = "Figure 18. Result of Tukey Test in the variable Percentage of Biomass of potato") +
  theme(plot.caption.position = "plot",
        plot.caption = element_text(hjust = 0))
```

```{r Figure 19. Result of Kruskal in Percentage of Biomass of potato}
#Biomass Kruskal Graph

ggplot(BiomassDistribution, aes(x=`Fractions`, y=Percentage.Biomass, fill=Treatment))+ylab("Biomass (%)")+
  geom_boxplot()+
  facet_grid(Cultivar~Year)+
  theme_light()+
  geom_text(data = LettersPH12,
            mapping = aes(x = Fractions,
                          y = mea + 5,
                          label = letra),
            position = position_dodge(0.9))+
  labs(caption = "Figure 19. Result of Kruskal in Percentage of Biomass of potato") +
  theme(plot.caption.position = "plot",
        plot.caption = element_text(hjust = 0))
```

```{r Figure 20 Normality of Residuals Percentage of Biomass}
#Residuals Biomass
anova.biomass<-aov(Percentage.Biomass~Treatment+`Fractions`+Year, data=BiomassDistribution) #anova 
anova.biomass.sqrt <- aov(sqrt(Percentage.Biomass)~Treatment+`Fractions`+Year, data=BiomassDistribution) #square root 
shapiro.test(anova.biomass$residuals) #0.06424
shapiro.test(anova.biomass.sqrt$residuals) #0.3364
par(mfrow = c(1, 2), oma = c(0, 0, 1.1, 0))
plot(anova.biomass, main = "ANOVA", which = 2, ask = F,sub.caption = "")
plot(anova.biomass.sqrt, main = "Square Root ANOVA", which = 2, ask = F,sub.caption = "")
```
<font size="1"> Figure 20 Normality of Residuals Percentage of Biomass</font>

```{r}
#AIC and BIC Biomass
AIC(anova.biomass, anova.biomass.sqrt)
BIC(anova.biomass, anova.biomass.sqrt)
```

**2.2 Yield of Potato**

The Duncan and Tukey tests did not have differences (Figures 16 and 17). The Shapiro-Wilk normality test was performed for Anova with a p-vaÃ±ue higher than 0.05 both years and cultivars, that means that the data has a normal distribution (Figure 18).

Taking into account the yield of potato, we can observe that in both tests and in both years, in cultivar Svitanok kievski, the BZR 336g treatment generated the highest yield. However, for the cultivar Yuna, the difference between the two treatments was not significant at any time.


```{r,results='hide'}
#Duncan Yield 2015 Svitanok kievskiy
YieldOfPotato$Cultivar <- factor(YieldOfPotato$Cultivar)
Con <- YieldOfPotato$Cultivar == "Svitanok kievskiy" & YieldOfPotato$Year==2015
d1 <- YieldOfPotato[Con,]

model<-aov(Yield.Potato~Treatment,data=d1)
out <- duncan.test(model,"Treatment", 
                   main="Yield of potato")
#plot(out,variation="IQR")
out$groups$groups

letter1 <- character()
letter1 <- c(letter1,out$groups$groups)


#Duncan Yield 2015 Yuna
YieldOfPotato$Cultivar <- factor(YieldOfPotato$Cultivar)
Con1 <- YieldOfPotato$Cultivar == "Yuna" & YieldOfPotato$Year==2015
d2 <- YieldOfPotato[Con1,]

model<-aov(Yield.Potato~Treatment,data=d2)
out <- duncan.test(model,"Treatment", 
                   main="Yield of potato")
#plot(out,variation="IQR")
out
letter1 <- c(letter1,out$groups$groups)

#Duncan Yield 2016 Svitanok kievskiy
YieldOfPotato$Cultivar <- factor(YieldOfPotato$Cultivar)
Con1234 <- YieldOfPotato$Cultivar == "Svitanok kievskiy" & YieldOfPotato$Year==2016
d1234 <- YieldOfPotato[Con1234,]

model<-aov(Yield.Potato~Treatment,data=d1234)
out <- duncan.test(model,"Treatment", 
                   main="Yield of potato")
#plot(out,variation="IQR")
out
letter1 <- c(letter1,out$groups$groups)

#Duncan Yield 2016 Yuna
YieldOfPotato$Cultivar <- factor(YieldOfPotato$Cultivar)
Con12345 <- YieldOfPotato$Cultivar == "Yuna" & YieldOfPotato$Year==2016
d2345 <- YieldOfPotato[Con12345,]

model<-aov(Yield.Potato~Treatment,data=d2345)
out <- duncan.test(model,"Treatment", 
                   main="Yield of potato")
#plot(out,variation="IQR")
out
letter1 <- c(letter1,out$groups$groups)

#Tukey Yield 2015 Svitanok kievskiy
YieldOfPotato$Cultivar <- factor(YieldOfPotato$Cultivar)
Con0 <- YieldOfPotato$Cultivar == "Svitanok kievskiy" & YieldOfPotato$Year==2015
t1 <- YieldOfPotato[Con0,]

model<-aov(Yield.Potato~Treatment,data=t1)
out1 <- HSD.test(model,"Treatment", console =TRUE)
out1$groups$groups

lettert <- character()
lettert <- c(lettert,out1$groups$groups)


#Tukey Yield 2015 Yuna
YieldOfPotato$Cultivar <- factor(YieldOfPotato$Cultivar)
Con10 <- YieldOfPotato$Cultivar == "Yuna" & YieldOfPotato$Year==2015
t2 <- YieldOfPotato[Con10,]

model<-aov(Yield.Potato~Treatment,data=t2)
out1 <- HSD.test(model,"Treatment", console =TRUE)
lettert <- c(lettert,out1$groups$groups)


#Tukey Yield 2016 Svitanok kievskiy
YieldOfPotato$Cultivar <- factor(YieldOfPotato$Cultivar)
Cont <- YieldOfPotato$Cultivar == "Svitanok kievskiy" & YieldOfPotato$Year==2016
t3 <- YieldOfPotato[Cont,]

model<-aov(Yield.Potato~Treatment,data=t3)
out1 <- HSD.test(model,"Treatment", console =TRUE)
lettert <- c(lettert,out1$groups$groups)

#Tukey Yield 2016 Yuna
YieldOfPotato$Cultivar <- factor(YieldOfPotato$Cultivar)
Con12345 <- YieldOfPotato$Cultivar == "Yuna" & YieldOfPotato$Year==2016
t4 <- YieldOfPotato[Con12345,]

model<-aov(Yield.Potato~Treatment,data=t4)
out1 <- HSD.test(model,"Treatment", console =TRUE)
lettert <- c(lettert,out1$groups$groups)


#Kruskal Yield 2015 Svitanok kievskiy
YieldOfPotato$Cultivar <- factor(YieldOfPotato$Cultivar)
Con0 <- YieldOfPotato$Cultivar == "Svitanok kievskiy" & YieldOfPotato$Year==2015
k1 <- YieldOfPotato[Con0,]

kw <- kruskal(k1$Yield.Potato, k1$Treatment)
kw$groups

letterk <- character()
letterk <- c(letterk,out1$groups$groups)


#Kruskal Yield 2015 Yuna
YieldOfPotato$Cultivar <- factor(YieldOfPotato$Cultivar)
Con10 <- YieldOfPotato$Cultivar == "Yuna" & YieldOfPotato$Year==2015
k2 <- YieldOfPotato[Con10,]

kw <- kruskal(k2$Yield.Potato, k2$Treatment)
kw$groups

letterk <- c(letterk,out1$groups$groups)


#Kruskal Yield 2016 Svitanok kievskiy
YieldOfPotato$Cultivar <- factor(YieldOfPotato$Cultivar)
Cont <- YieldOfPotato$Cultivar == "Svitanok kievskiy" & YieldOfPotato$Year==2016
k3 <- YieldOfPotato[Cont,]

kw <- kruskal(k3$Yield.Potato, k3$Treatment)
kw$groups

letterk <- c(letterk,out1$groups$groups)

#Kruskal Yield 2016 Yuna
YieldOfPotato$Cultivar <- factor(YieldOfPotato$Cultivar)
Con12345 <- YieldOfPotato$Cultivar == "Yuna" & YieldOfPotato$Year==2016
k4 <- YieldOfPotato[Con12345,]

kw <- kruskal(k4$Yield.Potato, k4$Treatment)
kw$groups

letterk <- c(letterk,out1$groups$groups)
```

```{r}
library(ggplot2)
library(ggpubr)
#Duncan Yield Graph 
#Create data frame 
dat_text <- data.frame(
  label = letter1,
  Year   = c(rep(2015,6),rep(2016,6)),
  Treatment = rep(levels(as.factor(YieldOfPotato$Treatment)),4),
  Cultivar= c("Svitanok kievskiy","Svitanok kievskiy","Svitanok kievskiy","Yuna","Yuna","Yuna","Svitanok kievskiy","Svitanok kievskiy","Svitanok kievskiy","Yuna","Yuna","Yuna"))
```


```{r Figure 21. Results of Duncan test Yield of potato}
duncanyieldgraph <- ggplot(YieldOfPotato, aes(x=`Cultivar`, y=Yield.Potato, fill=Treatment))+ylab("Yield of potato(t/ha)")+
  geom_boxplot()+
  facet_grid(.~Year)+
  theme_light()+
  geom_text(data = dat_text,
            mapping = aes(x = Cultivar,
                          y = c(29.7, 23.8,21.8, 28,27,22,20.5,17.9,13.1,21,21.6,16.8),
                          label = letter1),
            position = position_dodge(0.9))+
  labs(caption = "Figure 21. Results of Duncan test Yield of potato") +
  theme(plot.caption.position = "plot",
        plot.caption = element_text(hjust = 0))
duncanyieldgraph
```


```{r}
#Tukey Yield Graph 
#Create data frame 
dat_text1 <- data.frame(
  label = lettert,
  Year   = c(rep(2015,6),rep(2016,6)),
  Treatment = rep(levels(as.factor(YieldOfPotato$Treatment)),4),
  Cultivar= c("Svitanok kievskiy","Svitanok kievskiy","Svitanok kievskiy","Yuna","Yuna","Yuna","Svitanok kievskiy","Svitanok kievskiy","Svitanok kievskiy","Yuna","Yuna","Yuna"))
```


```{r Figure 22. Results of Tukey test Yield of potato}
tukeyyieldgraph <- ggplot(YieldOfPotato, aes(x=`Cultivar`, y=Yield.Potato, fill=Treatment))+ylab("Yield of potato(t/ha)")+
  geom_boxplot()+
  facet_grid(.~Year)+
  theme_light()+
  geom_text(data = dat_text1,
            mapping = aes(x = Cultivar,
                          y = c(29.7, 23.8,21.8, 28,27,22.5,20.5,17.9,13.1,21.3,21.6,16.8),
                          label = lettert),
            position = position_dodge(0.9))+
  labs(caption = "Figure 22. Results of Tukey test Yield of potato") +
  theme(plot.caption.position = "plot",
        plot.caption = element_text(hjust = 0))
tukeyyieldgraph
```

```{r}
#Kruskal Yield Graph 
#Create data frame 
dat_textk <- data.frame(
  label = letterk,
  Year   = c(rep(2015,6),rep(2016,6)),
  Treatment = rep(levels(as.factor(YieldOfPotato$Treatment)),4),
  Cultivar= c("Svitanok kievskiy","Svitanok kievskiy","Svitanok kievskiy","Yuna","Yuna","Yuna","Svitanok kievskiy","Svitanok kievskiy","Svitanok kievskiy","Yuna","Yuna","Yuna"))
```


```{r Figure 23. Results of Kruskal test Yield of potato}
kruskalyieldgraph <- ggplot(YieldOfPotato, aes(x=`Cultivar`, y=Yield.Potato, fill=Treatment))+ylab("Yield of potato(t/ha)")+
  geom_boxplot()+
  facet_grid(.~Year)+
  theme_light()+
  geom_text(data = dat_textk,
            mapping = aes(x = Cultivar,
                          y = c(29.7, 23.8,21.8, 28,27,22,20.5,17.9,13.1,21,21.6,16.8),
                          label = letter1),
            position = position_dodge(0.9))+
  labs(caption = "Figure 23. Results of Kruskal test Yield of potato") +
  theme(plot.caption.position = "plot",
        plot.caption = element_text(hjust = 0))
kruskalyieldgraph

```

```{r}
#Residuals 

#Residuals Yield 2015 Svitanok kievskiy
YieldOfPotato$Cultivar <- factor(YieldOfPotato$Cultivar)
Con <- YieldOfPotato$Cultivar == "Svitanok kievskiy" & YieldOfPotato$Year==2015
d1 <- YieldOfPotato[Con,]
anova.yieldsk<-aov(Yield.Potato~Treatment,data=d1) #anova 
anova.yieldsk.sqrt <- aov(sqrt(Yield.Potato)~Treatment,data=d1) #square root 
shapiro.test(anova.yieldsk$residuals) #0.0553
#shapiro.test(anova.yieldsk.sqrt$residuals) #0.02795

#Residuals Yield 2015 Yuna
YieldOfPotato$Cultivar <- factor(YieldOfPotato$Cultivar)
Con1 <- YieldOfPotato$Cultivar == "Yuna" & YieldOfPotato$Year==2015
d2 <- YieldOfPotato[Con1,]
anova.yieldy<-aov(Yield.Potato~Treatment,data=d2)#anova 
anova.yieldy.sqrt <- aov(sqrt(Yield.Potato)~Treatment,data=d2) #square root
shapiro.test(anova.yieldy$residuals) #0.4242
#shapiro.test(anova.yieldy.sqrt$residuals) #0.3887

#Residuals Yield 2016 Svitanok kievskiy
YieldOfPotato$Cultivar <- factor(YieldOfPotato$Cultivar)
Con1234 <- YieldOfPotato$Cultivar == "Svitanok kievskiy" & YieldOfPotato$Year==2016
d1234 <- YieldOfPotato[Con1234,]
anova.yieldsk6<-aov(Yield.Potato~Treatment,data=d1234)#anova
anova.yieldsk6.sqrt <- aov(sqrt(Yield.Potato)~Treatment,data=d1234)#square root
shapiro.test(anova.yieldsk6$residuals) #0.1674
#shapiro.test(anova.yieldsk6.sqrt$residuals) #0.1481

#Residuals Yield 2016 Yuna
YieldOfPotato$Cultivar <- factor(YieldOfPotato$Cultivar)
Con12345 <- YieldOfPotato$Cultivar == "Yuna" & YieldOfPotato$Year==2016
d2345 <- YieldOfPotato[Con12345,]
anova.yieldy6<-aov(Yield.Potato~Treatment,data=d2345) #anova
anova.yieldy6.sqrt <- aov(sqrt(Yield.Potato)~Treatment,data=d2345) #square root
shapiro.test(anova.yieldy6$residuals) #0.6108
#shapiro.test(anova.yieldy6.sqrt$residuals) #0.6299
```


```{r Figure 24. Normality of Residuals Yield of Potato}
#Graph 
par(mfrow = c(2, 2), oma = c(0, 0, 1.1, 0))
p1 <- plot(anova.yieldsk, main = "ANOVA 2015 SK", which = 2, ask = F,sub.caption = "") 
p2 <- plot(anova.yieldy, main = "ANOVA 2015 Y", which = 2, ask = F,sub.caption = "") 
p3 <- plot(anova.yieldsk6, main = "ANOVA 2016 SK", which = 2, ask = F,sub.caption = "") 
p4 <- plot(anova.yieldy6, main = "ANOVA 2016 y", which = 2, ask = F,sub.caption = "")
```

<font size="1"> Figure 24. Normality of Residuals Yield of Potato</font>

**3) *In vitro* antifungal activity of *Bacillus strains* against the phytopathogenic fungus *R. solani*, isolated from infected potato tubers**

**3.1 Growth of the diameter of the colonies of *R. solani* under the influence of *B. velezensis* after 3, 5 and 7 days**

Clear differences were observed over time between the colonial growth of *R. solani* under the effect of different treatments with *B. velezensis* and the control (Figure 25). All treatments showed lower initial colonial growth (day 3) compared to the control, also they showed a progressive growth in colony diameter at day 5 and 7. Treatment BZR 517 10e+06 is the only one that shows a decrease in colonial growth at day 7 compared to day 5.

```{r,results='hide',message=FALSE}

##### 1. ANTAGONISTIC ACTIVITY

#### Antagonistic activity was evaluated by measuring the diameter of the fungal 
#### colonies after 3, 5, and 7 days. The fungal inhibition (%) was determined 
#### based on the data obtained. 

#### All results were expressed and analyzed as the mean.

#### 1.1 Mean and Standard error for Fungal diameter for each treatment.

## Creating a new plot with means and standard errors

#install.packages("dplyr")

library("dplyr")

plot.means <- AntagonisticActivity %>%
  group_by(Days,Trat) %>%
  summarize(n = n(),
            mean = mean(Colony.Diameter),
            sd = sd(Colony.Diameter),
            se = sd / sqrt(n))

```


```{r Figure 25. Progression of colonial growth of R. solani under the antagonistic effect of two B. velezensis strains in vitro}
##Graph the influence of treatments on the fungal diameter growth after 3, 5 and 7 days.

#install.packages("ggplot2")

library(ggplot2)

ggplot(plot.means, aes(x = Days,
                       y = mean,
                       group=Trat,
                       color=Trat)) +
  geom_point(size = 3) +
  geom_line(size = 1) +
  geom_errorbar(aes(ymin=mean-se,
                    ymax=mean+se),
                width = .1)+
  labs(caption = "Figure 25. Progression of colonial growth of R. solani under the antagonistic effect of two B. velezensis strains in vitro",
       x = "Days",
       y = "Colony diameter (cm)",
       color = "Treatment") +theme_light()+ guides(col=guide_legend("Treatments")) +
  theme(plot.caption.position = "plot",
        plot.caption = element_text(hjust = 0))

```

**3.2 Inhibition of the growth of *R. solani* under the influence of different *B. velezensis* treatments after 3, 5 and 7 days *in vitro* **
  
The studied *B. velezensis* strains BZR 336 g and BZR 517 inhibited the growth of *R. solani* under laboratory conditions. The inhibition ratio depended on the concentration of *B. velezensis* in the nutrient medium, and it showed a decrease over time.

For determining the treatments with the best performance at day 3, 5 and 7, multiple comparison of means was performed by using Duncan's non-parametric test, according with authors' method. In addition, Tukey's parametric test and Kruskal-Wallis non-parametric test were performed to know the different groupings among analyzes. 

The Shapiro-Wilk normality test was performed for ANOVA, the p values at 3, 5 and 7 days were less than alpha=0.05, which means that the null hypothesis that the data are normally distributed is rejected (Figure 29). Since the data does not follow a normal distribution, the most appropriate is to perform non-parametric tests, which does not assume normality. This is consistent with the authors' decision to analyze the data with Duncan's test, and also strengthens our decision to perform another non-parametric test, Kruskal-Wallis, which is considered more robust. Even if data is not normal, ANOVA test should be still performed.

For days 3, 5 and 7 there were significant differences between treatments. In an overall perspective, only few differences were found between Duncan, Tukey and Kruskal-Wallis groupings (Figures 26, 27, and 28). 

On day 3, data grouping showed significant differences between the treatments and the control, while the differences between treatments were not clear enough to make conjectures. Data clustered differently across tests, showing differences. Control showed a fungal colony diameter (FCD) of 4.24 cm.

On day 5, there were significant differences between the treatments and the control, also there were significant differences between treatments. Data clustered very similarly across tests, showing only very few differences. All tests agreed that the treatments with the high concentration (10^6 CFU/mL) of BZR 336 g and medium concentrations (10^5 CFU/mL) of both strains (BZR 336 g and BZR 517) had the best performance with FCD of 1.62 and 1.72 cm, respectively. Control showed a fungal FCD of 7.86 cm. 

On day 7, there were significant differences between the treatments and the control, and also between treatments. Data clustered equally across tests, showing no differences. All tests agreed that treatments with high (10^6 CFU/mL) and medium (10^5 CFU/mL) concentration of both strains (BZR 517 and BZR 336 g) had the best performance with FCD of 1.64, 1.72, 1.82 and 1.82 cm, respectively. Control showed a fungal FCD of 9 cm.

Only treatment BZR 517 at its higher concentration (10^6 CFU/mL) showed a decrease in FCD on day 7 in comparison with day 5. The rest of the treatments showed a progressive increment of FCD over time.

```{r,results='hide',message=FALSE}
#### 1.2 Statistical Analysis

### 1.2.1 Duncan, ANOVA and Kruskal-Wallis test

### Multiple comparisons of the means were performed by using Duncan, ANOVA and
### Kruskal-Wallis test with a significance level of p = 0.05.

## Duncan analysis for Fungal colony diameter at 3 d
library ("agricolae")
Dia <- 3

AntagonisticActivity$Days <- factor(AntagonisticActivity$Days)
Y1 <- AntagonisticActivity$Days==Dia
AA <- AntagonisticActivity[Y1,]

model <- aov(Colony.Diameter~Trat,data=AA)
out <- duncan.test(model,"Trat",main = "Colony diameter")
out

#plot(out,variation="IQR")

## Tukey analysis for Fungal colony diameter at 3 d

out.hsd <- HSD.test(model,"Trat",console = TRUE)

## Kruskal-Wallis analysis for Fungal colony diameter at 3 d

library(agricolae)

kw.3d<-with(AA,kruskal(Colony.Diameter,Trat,group=TRUE, main=NULL, console = TRUE))

## Duncan analysis for Fungal colony diameter at 5 d
Dia <- 5

AntagonisticActivity$Days <- factor(AntagonisticActivity$Days)
Y1 <- AntagonisticActivity$Days==Dia
AA <- AntagonisticActivity[Y1,]

model <- aov(Colony.Diameter~Trat,data=AA)
out <- duncan.test(model,"Trat",main = "Colony diameter")
out

#plot(out,variation="IQR")

## Tukey analysis for Fungal colony diameter at 5 d

out.hsd <- HSD.test(model,"Trat",console = TRUE)

## Kruskal-Wallis analysis for Fungal colony diameter at 5 d

library(agricolae)

kw.5d<-with(AA,kruskal(Colony.Diameter,Trat,group=TRUE, main=NULL, console = TRUE))

## Duncan analysis for Fungal colony diameter at 7 d
Dia <- 7

AntagonisticActivity$Days <- factor(AntagonisticActivity$Days)
Y1 <- AntagonisticActivity$Days==Dia
AA <- AntagonisticActivity[Y1,]

model <- aov(Colony.Diameter~Trat,data=AA)
out <- duncan.test(model,"Trat",main = "Colony diameter")
out

## Tukey analysis for Fungal colony diameter at 7 d

out.hsd <- HSD.test(model,"Trat",console = TRUE)

## Kruskal-Wallis analysis for Fungal colony diameter at 7 d

library(agricolae)

kw.7d<-with(AA,kruskal(Colony.Diameter,Trat,group=TRUE, main=NULL, console = TRUE))
```

```{r Figure 26. Duncan Test for Antagonistic activity of two strains of B. velezensis against R. solani in vitro}
## Combine Duncan graphs for 3, 5 and 7 d

#library(ggplot2)
#library(ggpubr)
#theme_set(theme_pubr())

DunLetters <- data.frame(Days=c(rep(3,7),rep(5,7),rep(7,7)),
                         Trat=c("Bacillus velezensis strain BZR 336 g 10000","Bacillus velezensis strain BZR 336 g 1e+05",
                                "Bacillus velezensis strain BZR 336 g 1e+06","Bacillus velezensis strain BZR 517 10000",
                                "Bacillus velezensis strain BZR 517 1e+05","Bacillus velezensis strain BZR 517 1e+06",
                                "Control 1e+06","Bacillus velezensis strain BZR 336 g 10000","Bacillus velezensis strain BZR 336 g 1e+05",
                                "Bacillus velezensis strain BZR 336 g 1e+06","Bacillus velezensis strain BZR 517 10000",
                                "Bacillus velezensis strain BZR 517 1e+05","Bacillus velezensis strain BZR 517 1e+06",
                                "Control 1e+06","Bacillus velezensis strain BZR 336 g 10000","Bacillus velezensis strain BZR 336 g 1e+05",
                                "Bacillus velezensis strain BZR 336 g 1e+06","Bacillus velezensis strain BZR 517 10000",
                                "Bacillus velezensis strain BZR 517 1e+05","Bacillus velezensis strain BZR 517 1e+06",
                                "Control 1e+06"),
                         Mean=plot.means$mean,
                         SE=plot.means$se,
                         label=c("bc","bcd","d","b","cd","bc","a","c","c","c","b","c","c","a","b","c","c","b","c","c","a"))

DunBox <- ggplot(AntagonisticActivity, aes(x=`Trat`, y=Colony.Diameter, fill=Trat))+xlab("Treatments")+ylab("Fungal colony diameter (cm)")+
  stat_boxplot(geom = "errorbar",
               width = 0.2) +
  geom_boxplot()+
  theme_light()+
  geom_text(data = DunLetters,
            mapping = aes(x = Trat,
                          y = Mean+1,
                          label=label),
            position = position_dodge(0.9))+
  facet_grid(.~Days)+
  labs(caption = "Figure 26. Duncan Test for Antagonistic activity of two strains of B. velezensis against R. solani in vitro") +
  scale_x_discrete(("Treatments"),limitedLabels("Treatments"))+
  scale_fill_discrete(("Treatments"))+
  theme(plot.caption.position = "plot",
        plot.caption = element_text(hjust = 0))

DunBox
```


```{r Figure 27. Tukey Test for Antagonistic activity of two strains of B. velezensis against R. solani in vitro}
## Tukey graphs for 3, 5 and 7 d

#library(ggplot2)
#library(ggpubr)
#theme_set(theme_pubr())

TukLetters <- data.frame(Days=c(rep(3,7),rep(5,7),rep(7,7)),
                         Trat=c("Bacillus velezensis strain BZR 336 g 10000","Bacillus velezensis strain BZR 336 g 1e+05",
                                "Bacillus velezensis strain BZR 336 g 1e+06","Bacillus velezensis strain BZR 517 10000",
                                "Bacillus velezensis strain BZR 517 1e+05","Bacillus velezensis strain BZR 517 1e+06",
                                "Control 1e+06","Bacillus velezensis strain BZR 336 g 10000","Bacillus velezensis strain BZR 336 g 1e+05",
                                "Bacillus velezensis strain BZR 336 g 1e+06","Bacillus velezensis strain BZR 517 10000",
                                "Bacillus velezensis strain BZR 517 1e+05","Bacillus velezensis strain BZR 517 1e+06",
                                "Control 1e+06","Bacillus velezensis strain BZR 336 g 10000","Bacillus velezensis strain BZR 336 g 1e+05",
                                "Bacillus velezensis strain BZR 336 g 1e+06","Bacillus velezensis strain BZR 517 10000",
                                "Bacillus velezensis strain BZR 517 1e+05","Bacillus velezensis strain BZR 517 1e+06",
                                "Control 1e+06"),
                         Mean=plot.means$mean,
                         SE=plot.means$se,
                         label=c("b","bc","c","b","bc","bc","a","bc","c","c","b","c","c","a","b","c","c","b","c","c","a"))

TukBox <- ggplot(AntagonisticActivity, aes(x=`Trat`, y=Colony.Diameter, fill=Trat))+xlab("Treatments")+ylab("Fungal colony diameter (cm)")+
  stat_boxplot(geom = "errorbar",
               width = 0.2) +
  geom_boxplot()+
  theme_light()+
  geom_text(data = TukLetters,
            mapping = aes(x = Trat,
                          y = Mean+1,
                          label=label),
            position = position_dodge(0.9))+
  facet_grid(.~Days)+
  labs(caption = "Figure 27. Tukey Test for Antagonistic activity of two strains of B. velezensis against R. solani in vitro") +
  scale_x_discrete(("Treatments"),limitedLabels("Treatments"))+
  scale_fill_discrete(("Treatments"))+
  theme(plot.caption.position = "plot",
        plot.caption = element_text(hjust = 0))

TukBox
```


```{r Figure 28. Kruskal Test for Antagonistic activity of two strains of B. velezensis against R. solani in vitro}
## Kruskal-Wallis graphs for 3, 5 and 7 d

library(ggplot2)
library(ggpubr)
theme_set(theme_pubr())

KWLetters <- data.frame(Days=c(rep(3,7),rep(5,7),rep(7,7)),
                         Trat=c("Bacillus velezensis strain BZR 336 g 10000","Bacillus velezensis strain BZR 336 g 1e+05",
                                "Bacillus velezensis strain BZR 336 g 1e+06","Bacillus velezensis strain BZR 517 10000",
                                "Bacillus velezensis strain BZR 517 1e+05","Bacillus velezensis strain BZR 517 1e+06",
                                "Control 1e+06","Bacillus velezensis strain BZR 336 g 10000","Bacillus velezensis strain BZR 336 g 1e+05",
                                "Bacillus velezensis strain BZR 336 g 1e+06","Bacillus velezensis strain BZR 517 10000",
                                "Bacillus velezensis strain BZR 517 1e+05","Bacillus velezensis strain BZR 517 1e+06",
                                "Control 1e+06","Bacillus velezensis strain BZR 336 g 10000","Bacillus velezensis strain BZR 336 g 1e+05",
                                "Bacillus velezensis strain BZR 336 g 1e+06","Bacillus velezensis strain BZR 517 10000",
                                "Bacillus velezensis strain BZR 517 1e+05","Bacillus velezensis strain BZR 517 1e+06",
                                "Control 1e+06"),
                         Mean=plot.means$mean,
                         SE=plot.means$se,
                         label=c("b","c","d","b","c","bc","a","b","c","c","b","c","b","a","b","c","c","b","c","c","a"))

KWBox <- ggplot(AntagonisticActivity, aes(x=`Trat`, y=Colony.Diameter, fill=Trat))+xlab("Treatments")+ylab("Fungal colony diameter (cm)")+
  stat_boxplot(geom = "errorbar",
               width = 0.2) +
  geom_boxplot()+
  theme_light()+
  geom_text(data = KWLetters,
            mapping = aes(x = Trat,
                          y = Mean+1,
                          label=label),
            position = position_dodge(0.9))+
  facet_grid(.~Days)+
  labs(caption = "Figure 28. Kruskal Test for Antagonistic activity of two strains of B. velezensis against R. solani in vitro") +
  scale_x_discrete(("Treatments"),limitedLabels("Treatments"))+
  scale_fill_discrete(("Treatments"))+
  theme(plot.caption.position = "plot",
        plot.caption = element_text(hjust = 0))

KWBox
```


```{r}
## Residuals for Antagonistic activity

##Residuals for day 3
library ("agricolae")
Dia <- 3

AntagonisticActivity$Days <- factor(AntagonisticActivity$Days)
Y1 <- AntagonisticActivity$Days==Dia
AA <- AntagonisticActivity[Y1,]

anova.3d <- aov(Colony.Diameter~Trat,data=AA) #anova 
anova.3d.sqrt <- aov(sqrt(Colony.Diameter)~Trat,data=AA) #square root 
shapiro.test(anova.3d$residuals) #0.01891
shapiro.test(anova.3d.sqrt$residuals) #0.3884

##Residuals for day 5
library ("agricolae")
Dia <- 5

AntagonisticActivity$Days <- factor(AntagonisticActivity$Days)
Y1 <- AntagonisticActivity$Days==Dia
AA <- AntagonisticActivity[Y1,]

anova.5d <- aov(Colony.Diameter~Trat,data=AA) #anova 
anova.5d.sqrt <- aov(sqrt(Colony.Diameter)~Trat,data=AA) #square root 
shapiro.test(anova.5d$residuals) #1.646 e-06
shapiro.test(anova.5d.sqrt$residuals) #1.099 e-05

##Residuals for day 7
library ("agricolae")
Dia <- 7

AntagonisticActivity$Days <- factor(AntagonisticActivity$Days)
Y1 <- AntagonisticActivity$Days==Dia
AA <- AntagonisticActivity[Y1,]

anova.7d <- aov(Colony.Diameter~Trat,data=AA) #anova 
anova.7d.sqrt <- aov(sqrt(Colony.Diameter)~Trat,data=AA) #square root 
shapiro.test(anova.7d$residuals) #3.084 e-06
shapiro.test(anova.7d.sqrt$residuals) #2.288 e-05
```


```{r Figure 29. Normality of Residuals for Antagonistic activity}
#Graph 
par(mfrow = c(2, 2), oma = c(0, 0, 1.1, 0))
p1 <- plot(anova.3d, main = "ANOVA at 3 days", which = 2, ask = F,sub.caption = "") 
p2 <- plot(anova.5d, main = "ANOVA at 5 days", which = 2, ask = F,sub.caption = "") 
p3 <- plot(anova.7d, main = "ANOVA at 7 days", which = 2, ask = F,sub.caption = "") 
```
<font size="1"> Figure 29. Normality of Residuals for Antagonistic activity</font> 


## Conclusions 

It can be said that this article in question has very little data to be worked on and therefore the differences between the Tukey and Duncan tests were not significant, which also justifies the authors' choice of use the Duncan test. About the treatments, in general we can said that the treatment with BZR 336g was what generated the best results in the control of the disease and also in practically all morphological aspects. Only when we talk about the biomass, the BZR 517 treatment showed the best results. In this way, we can say that the article did the best that was possible with the informations that they have.

From the observation that several data sets do not follow a normal distribution, it can be inferred that the authors preferred to perform the mean comparison analysis using the Duncan test, since this can be applied in the same conditions of the Tukey's test, but with a significance less cautionary. Due to the lack of robustness of Duncan's test there are some cautions to follow, as many times it cannot be accepted as a proof of differences.

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
